# Context Store Configuration Example
# Copy this file to .ctxrc.yaml and customize for your environment

# System configuration
system:
  environment: production  # development, staging, production
  debug: false

# Embedding configuration
embedding:
  dimensions: 1536  # Must match your embedding model output
  model: text-embedding-ada-002
  batch_size: 100
  max_retries: 3
  timeout: 30

# Storage configuration
storage:
  backend: multi  # single, multi
  primary: neo4j
  cache: redis
  analytics: duckdb

# Agent configuration
agents:
  max_concurrent: 10
  timeout: 300
  retry_policy:
    max_attempts: 3
    backoff_multiplier: 2

# Database configurations
qdrant:
  host: localhost
  port: 6333
  collection: context_store
  ssl: true
  api_key: ${QDRANT_API_KEY}  # Use environment variable
  grpc_port: 6334
  prefer_grpc: true
  connection_pool:
    min_size: 5
    max_size: 20

neo4j:
  uri: bolt://localhost:7687
  database: neo4j
  ssl: true
  trust: TRUST_SYSTEM_CA_SIGNED_CERTIFICATES
  connection_pool:
    min_size: 5
    max_size: 20
    acquisition_timeout: 30
    max_lifetime: 3600

redis:
  host: localhost
  port: 6379
  database: 0
  ssl: true
  password: ${REDIS_PASSWORD}  # Use environment variable
  connection_pool:
    min_size: 5
    max_size: 50
    socket_timeout: 5
    socket_connect_timeout: 5

duckdb:
  database_path: /var/lib/context-store/analytics.db
  threads: 4
  memory_limit: 4GB
  temp_directory: /tmp/duckdb

# MCP Server configuration
mcp:
  server_port: 8080
  host: 0.0.0.0
  tools:
    - store_context
    - retrieve_context
    - query_graph
  cors:
    enabled: true
    origins:
      - http://localhost:3000
      - https://your-domain.com

# Security configuration
security:
  max_query_length: 10000
  query_timeout: 30
  allowed_operations:
    - MATCH
    - WITH
    - RETURN
    - WHERE
    - ORDER BY
    - LIMIT
    - SKIP
  forbidden_operations:
    - CREATE
    - DELETE
    - SET
    - REMOVE
    - MERGE
    - DROP
  rate_limiting:
    enabled: true
    requests_per_minute: 60
    burst_size: 10

# SSL/TLS configuration
ssl:
  neo4j:
    enabled: true
    cert_file: /path/to/neo4j-cert.pem
    key_file: /path/to/neo4j-key.pem
    verify_mode: CERT_REQUIRED
  qdrant:
    enabled: true
    verify_ssl: true
    ca_cert: /path/to/qdrant-ca.pem
  redis:
    enabled: true
    ssl_certfile: /path/to/redis-cert.pem
    ssl_keyfile: /path/to/redis-key.pem
    ssl_ca_certs: /path/to/redis-ca.pem
    check_hostname: true
    verify_certs: true

# Cache configuration
cache:
  ttl_seconds: 3600
  max_size: 1000
  eviction_policy: lru  # lru, lfu, ttl

# Logging configuration
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: /var/log/context-store/app.log
  max_bytes: 10485760  # 10MB
  backup_count: 5

# Monitoring configuration
monitoring:
  enabled: true
  metrics_port: 9090
  health_check_path: /health
  readiness_check_path: /ready

# Performance tuning
performance:
  vector_db:
    embedding:
      batch_size: 100
      max_retries: 3
      request_timeout: 30
    search:
      default_limit: 10
      max_limit: 100
      score_threshold: 0.7
  graph_db:
    connection_pool:
      min_size: 5
      max_size: 20
    query:
      max_path_length: 5
      timeout: 30
  kv_store:
    redis:
      connection_pool:
        min_size: 5
        max_size: 50
      cache:
        ttl_seconds: 3600
    duckdb:
      batch_insert:
        size: 1000
      analytics:
        retention_days: 90
